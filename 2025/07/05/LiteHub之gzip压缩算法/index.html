<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Qingyh">
    
    <title>
        
            LiteHubä¹‹gzipå‹ç¼©ç®—æ³• |
        
        é˜¿å¯’çš„å­¦ä¹ å±‹
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/logo.svg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"é˜¿å¯’çš„å­¦ä¹ å±‹","author":"Qingyh","avatar":"/images/avatar.svg","logo":"/images/logo.svg","favicon":"/images/logo.svg"},"menu":{"home":"/","archives":"/å½’æ¡£","links":"/links","about":"/LiteHub"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":true,"percent":false,"hide_header":true},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":false,"style":"default"},"highlight_theme":"default"},"toc":{"enable":false,"number":false,"expand_all":false,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":false,"preload":false},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.39"},"waline":{"server_url":null,"reaction":false,"version":"3.3.2"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2020,"word_count":false,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.2.5"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original post title","author":"Original post author","link":"Original post link"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
.progress-bar-container {
  position fixed
  top 0
  left 0
  z-index $z-index-9
  width 100%

  if (hexo-config('pjax') && hexo-config('pjax.enable') == true) {

    .pjax-progress-bar {
      position absolute
      top 0
      left 0
      z-index $z-index-8
      width 0
      height 2px
      background var(--pjax-progress-bar-color)
      visibility hidden
      opacity 0
      transition-t("width, opacity", "0, 0", "0.1, 0.1", "linear")


      &.show {
        visibility visible
        opacity 1
      }
    }


    .pjax-progress-icon {
      position absolute
      top 0.4rem
      right 0.3rem
      z-index $z-index-8
      color var(--text-color-3)
      font-size 1.1rem
      visibility hidden

      +keep-tablet() {
        top 0.3rem
        right 0.2rem
        font-size 1rem
      }

      &.show {
        visibility visible
      }
    }
  }

  if (hexo-config('scroll') && hexo-config('scroll.progress_bar') == true) {
    .scroll-progress-bar {
      position absolute
      top 0
      left 0
      z-index $z-index-7
      width 0
      height var(--header-scroll-progress-bar-height)
      background var(--primary-color)
      visibility hidden
      transition-t("width", "0", "0.1", "linear")

      &.hide {
        display none !important
      }
    }
  }
}


<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            $pc-search-icon-font-size = 1.5rem
$menu-bar-line-height = 2.5px
$menu-icon-gap = 0.1rem
$pc-menu-item-gap = 1.8rem
$mobile-menu-item-gap = 1.2rem
$logo-image-box-width = 2.68rem
$mobile-menu-icon-wrap-width = 1.6rem
$mobile-menu-icon-wrap-margin = 0.4rem


.header-wrapper {
  display flex
  align-items center
  justify-content center
  box-sizing border-box
  width 100%
  height 100%
  padding-top var(--header-scroll-progress-bar-height)
  background var(--background-color-1)
  box-shadow 1px 2px 6px var(--shadow-color)

  &:hover {
    box-shadow 1px 2px 10px var(--shadow-hover-color)
  }


  .header-content {
    z-index $z-index-5
    display flex
    flex-direction row
    align-items center
    justify-content space-between
    width var(--page-content-width)
    max-width var(--page-content-max-width)
    height 100%
    transition-t("max-width, width", "0, 0", "0.1, 0.1", "ease, ease")

    &.has-first-screen {
      max-width var(--page-content-max-width-2)
    }


    .has-toc & {
      max-width var(--page-content-max-width-2)
    }


    +keep-tablet() {
      width var(--page-content-width-tablet)
    }


    +keep-mobile() {
      width var(--page-content-width-mobile)
    }


    .left {
      height 100%
      font-size 2rem

      transition-t("transform, transform-origin", "0, 0", "0.2, 0.2", "linear, linear")

      .header-shrink & {
        transform scale(0.78)
        transform-origin left
      }


      if (hexo-config('base_info') && hexo-config('base_info.logo')) {
        .logo-image {
          flex-shrink 0
          width $logo-image-box-width
          height $logo-image-box-width
          margin-right 0.5rem


          +keep-tablet() {
            width $logo-image-box-width * 0.9
            height $logo-image-box-width * 0.9
          }


          +keep-mobile() {
            width $logo-image-box-width * 0.8
            height $logo-image-box-width * 0.8
          }


          img {
            width 100%
            border-radius 0.4rem
          }
        }
      }


      .site-name {
        color var(--text-color-1)
        font-weight 600
        font-size var(--header-title-font-size)
        font-family var(--header-title-font-family)
        line-height 1
        letter-spacing 1px

        +keep-tablet() {
          font-size calc(var(--header-title-font-size) * 0.9)
        }


        +keep-mobile() {
          font-size calc(var(--header-title-font-size) * 0.8)
        }


        .is-home & {
          if (hexo-config('first_screen') && hexo-config('first_screen.enable') == true) {
            color var(--first-screen-header-font-color-light)
            filter brightness(92%)

            .dark-mode & {
              color var(--first-screen-header-font-color-dark)
              filter brightness(106%)
            }
          }
        }


        .show-header-drawer & {
          color var(--text-color-1) !important
        }
      }
    }


    .right {
      .pc {
        .menu-list {
          display flex
          gap $pc-menu-item-gap
          align-items center

          +keep-tablet() {
            display none
          }


          .menu-item {
            font-size 1rem
            cursor pointer

            &.search {
              font-size $pc-search-icon-font-size
              &::before {
                display none !important
              }
            }


            .menu-text-color {
              color var(--text-color-3)
            }


            &::before {
              position absolute
              bottom -10px
              left 50%
              box-sizing border-box
              width 0
              height 2.6px
              background var(--primary-color)
              border-radius 3px
              transform translateX(-50%)
              content ''
              transition-t("transform, bottom, width", "0, 0, 0", "0.2, 0.2, 0.2", "linear, linear, ease")

              .header-shrink & {
                bottom calc(-1 * calc(var(--header-shrink-height) * 0.5 - 12px))
              }
            }


            &:hover
            &.active {
              &::before {
                width 100%
              }
            }


            .menu-icon {
              display var(--header-menu-icon)
              margin-right $menu-icon-gap
            }


            .is-home & {
              if (hexo-config('first_screen') && hexo-config('first_screen.enable') == true) {
                .menu-text-color {
                  color var(--first-screen-header-font-color-light)
                }


                .dark-mode & {
                  .menu-text-color {
                    color var(--first-screen-header-font-color-dark)
                  }
                }
              }
            }


            &.has-sub-menu {
              &::after {
                position absolute
                bottom 0
                left 0
                box-sizing border-box
                width 100%
                height 100%
                content ''
              }

              &:hover {
                &::after {
                  bottom -100%
                }

                .collapse-icon {
                  transform rotate(180deg)
                }

                .sub-menu-list {
                  display flex
                }
              }
            }


            .collapse-icon {
              margin-left $menu-icon-gap
              transition-t("transform", "0", "0.3", "ease")
            }
          }


          .sub-menu-list {
            position absolute
            bottom -280%
            left 50%
            display none
            gap $pc-menu-item-gap
            justify-content flex-start
            box-sizing border-box
            padding 0.8rem 1.6rem
            background var(--background-color-1)
            border-radius 0.6rem
            box-shadow 0 0 8px var(--shadow-color)
            transform translateX(-50%)

            .sub-menu-item {
              white-space nowrap

              .menu-text-color {
                color var(--text-color-3) !important
              }

              &:hover
              &.active {
                .menu-text-color {
                  color var(--primary-color) !important
                }
              }

              .sub-menu-icon {
                display var(--header-menu-icon)
                margin-right $menu-icon-gap * 4
              }
            }
          }
        }
      }


      .mobile {
        gap 1rem

        .icon-item {
          position relative
          display none
          width 20px
          height 20px
          color var(--text-color-3)
          font-size 1.2rem
          cursor pointer

          i {
            color var(--text-color-3)

            .show-header-drawer & {
              color var(--text-color-3) !important
            }

            .reset-color & {
              color var(--text-color-3) !important
            }
          }


          +keep-tablet() {
            display flex
            align-items center
            justify-content center
          }
        }


        .menu-bar {
          .menu-bar-middle {
            position relative
            width 18px
            height $menu-bar-line-height
            background var(--text-color-3)

            &::before
            &::after {
              position absolute
              left 0
              width 100%
              height $menu-bar-line-height
              background var(--text-color-3)
              content ''
              transition-t("transform", "0", "0.38", "ease")
            }


            &::before {
              top -6px

              .show-header-drawer & {
                transform translateY(6px) rotate(45deg)
              }
            }


            &::after {
              bottom -6px

              .show-header-drawer & {
                transform translateY(-6px) rotate(-45deg)
              }
            }


            .reset-color & {
              background var(--text-color-3) !important

              &::before
              &::after {
                background var(--text-color-3) !important
              }
            }


            .show-header-drawer & {
              background transparent !important

              &::before
              &::after {
                background var(--text-color-3) !important
              }
            }
          }
        }


        .is-home & {
          if (hexo-config('first_screen') && hexo-config('first_screen.enable') == true) {
            .icon-item i {
              color var(--first-screen-header-font-color-light)
            }

            .menu-bar .menu-bar-middle {
              background var(--first-screen-header-font-color-light)

              &::before
              &::after {
                background var(--first-screen-header-font-color-light)
              }
            }

            .dark-mode & {
              .icon-item i {
                color var(--first-screen-header-font-color-dark)
              }

              .menu-bar .menu-bar-middle {
                background var(--first-screen-header-font-color-dark)

                &::before
                &::after {
                  background var(--first-screen-header-font-color-dark)
                }
              }
            }
          }
        }
      }
    }
  }


  .header-drawer {
    position absolute
    top 0
    left 0
    z-index $z-index-2
    display none
    justify-content center
    box-sizing border-box
    width 100%
    padding var(--header-height) 0 2rem 0
    background var(--background-color-1)
    transform scaleY(0)
    transform-origin top
    transition-t("transform", "0", "0.38", "ease")

    +keep-tablet() {
      display flex
    }


    .show-header-drawer & {
      transform scaleY(1)
    }


    .drawer-menu-list {
      display flex
      flex-direction column
      gap 1.2rem
      align-items flex-start
      justify-content flex-start
      width var(--page-content-width)
      max-width var(--page-content-max-width)
      height 100%
      margin-top 1rem

      +keep-tablet() {
        width var(--page-content-width-tablet)
      }


      +keep-mobile() {
        width var(--page-content-width-mobile)
      }


      .drawer-menu-item {
        width 100%
        padding 0.6rem 0
        font-size 1.06rem
        border-bottom 0.1rem solid var(--background-color-3)

        &.active {
          .drawer-menu-label {
            .drawer-menu-text-color {
              color var(--primary-color)
            }
          }
        }


        &.show-sub-menu {
          .collapse-icon {
            transform rotate(-90deg)
          }


          .drawer-sub-menu-list {
            display flex
            height auto
          }
        }


        .drawer-menu-label {
          display flex
          align-items center
          justify-content space-between
          width 100%

          .left-side {
            width 100%

            .menu-icon-wrap {
              display var(--header-menu-icon)
              width $mobile-menu-icon-wrap-width
              margin-right $mobile-menu-icon-wrap-margin
            }
          }


          .right-side {
            margin-left 0.4rem
            cursor pointer
            transition-t("transform", "0", "0.2", "ease")
          }
        }
      }


      .drawer-sub-menu-list {
        position relative
        display none
        flex-direction column
        justify-content flex-start
        box-sizing border-box
        width 100%
        height 0
        padding-top 0.6rem
        padding-bottom 0.6rem
        padding-left $mobile-menu-icon-wrap-width
        transition-t("display, height", "0, 0", "0.2, 0.2", "linear, linear")
        disable-user-select()

        .sub-menu-item {
          margin-top 1rem
          padding 0.6rem 0

          &.active {
            a
            a i {
              color var(--primary-color)
            }
          }


          .sub-menu-icon-wrap {
            display var(--header-menu-icon)
            width $mobile-menu-icon-wrap-width
            margin-right $mobile-menu-icon-wrap-margin
          }
        }
      }
    }
  }


  .window-mask {
    position absolute
    top 0
    left 0
    z-index $z-index-1
    display none
    box-sizing border-box
    width 100%
    height 100vh
    background rgba(0, 0, 0, 0.4)
    visibility hidden
    opacity 0
    transition-t("transform, opacity", "0, 0", "0.38, 0.38", "ease, ease")

    +keep-tablet() {
      display block
    }


    .show-header-drawer & {
      visibility visible
      opacity 1
    }
  }
}


.show-header-drawer {
  overflow hidden
}

        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        LiteHubä¹‹gzipå‹ç¼©ç®—æ³•
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/avatar.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">Qingyh</span>
                                
                                    <span class="author-badge">Lv2</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2025-07-05 10:28:46</span>
            </span>

            
                <span class="meta-info-item post-update-date">
                    <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                    <span class="datetime" data-updated="Fri Jul 11 2025 10:43:55 GMT+0800">2025-07-11 10:43:55</span>
                </span>
            
        

        

        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <p>@<a href="gzip%E7%AE%97%E6%B3%95">TOC</a></p>
<h2 id="ç†è®ºéƒ¨åˆ†"><a href="#ç†è®ºéƒ¨åˆ†" class="headerlink" title="ç†è®ºéƒ¨åˆ†"></a>ç†è®ºéƒ¨åˆ†</h2><blockquote>
<p>gzipæ˜¯ä¸€ç§æ— æŸå‹ç¼©ç®—æ³•ï¼Œå…¶åŸºç¡€ä¸ºDeflateï¼ŒDeflateæ˜¯LZ77ä¸å“ˆå¼—æ›¼ç¼–ç çš„ä¸€ä¸ªç»„åˆä½“ã€‚å®ƒçš„åŸºæœ¬åŸç†æ˜¯ï¼šå¯¹äºè¦å‹ç¼©çš„æ–‡ä»¶ï¼Œé¦–å…ˆä½¿ç”¨LZ77ç®—æ³•çš„ä¸€ä¸ªå˜ç§è¿›è¡Œå‹ç¼©ï¼Œå¯¹å¾—åˆ°çš„ç»“æœå†ä½¿ç”¨å“ˆå¤«æ›¼ç¼–ç ï¼ˆæ ¹æ®æƒ…å†µï¼Œä½¿ç”¨é™æ€å“ˆå¼—æ›¼ç¼–ç æˆ–åŠ¨æ€å“ˆå¤«æ›¼ç¼–ç ï¼‰çš„æ–¹æ³•è¿›è¡Œå‹ç¼©ã€‚</p>
</blockquote>
<h3 id="LZ777ç®—æ³•"><a href="#LZ777ç®—æ³•" class="headerlink" title="LZ777ç®—æ³•"></a>LZ777ç®—æ³•</h3><p>å‡ ä¸ªæœ¯è¯­</p>
<ul>
<li>ç­‰å¾…ç¼–ç åŒº</li>
<li>æœç´¢ç¼“å†²åŒºï¼ˆå·²ç»ç¼–ç çš„åŒºåŸŸï¼‰</li>
<li>æ»‘åŠ¨çª—å£ï¼ˆæŒ‡å®šå¤§å°ï¼ŒåŒ…æ‹¬â€œæœç´¢ç¼“å†²åŒºâ€å’Œâ€œå¾…ç¼–ç åŒºâ€ï¼‰</li>
</ul>
<p>å…·ä½“çš„ç¼–ç è¿‡ç¨‹ï¼š<br>æ¥ä¸‹æ¥ï¼Œä»‹ç»å…·ä½“çš„ç¼–ç è¿‡ç¨‹ï¼š<br>ã€€ã€€ä¸ºäº†ç¼–ç å¾…ç¼–ç åŒºï¼Œ ç¼–ç å™¨åœ¨æ»‘åŠ¨çª—å£çš„æœç´¢ç¼“å†²åŒºæŸ¥æ‰¾ç›´åˆ°æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹å­—ç¬¦ä¸²ä¸å¾…ç¼–ç ç¼“å†²åŒºçš„è·ç¦»ç§°ä¸ºâ€œåç§»å€¼â€ï¼ŒåŒ¹é…å­—ç¬¦ä¸²çš„é•¿åº¦ç§°ä¸ºâ€œåŒ¹é…é•¿åº¦â€ã€‚<br>ã€€ã€€ç¼–ç å™¨åœ¨ç¼–ç æ—¶ï¼Œä¼šä¸€ç›´åœ¨æœç´¢åŒºä¸­æœç´¢ï¼Œç›´åˆ°æ‰¾åˆ°æœ€å¤§åŒ¹é…å­—ç¬¦ä¸²ï¼Œå¹¶è¾“å‡º(o, l )ï¼Œå…¶ä¸­oæ˜¯åç§»å€¼ï¼Œ læ˜¯åŒ¹é…é•¿åº¦ã€‚ç„¶åçª—å£æ»‘åŠ¨lï¼Œç»§ç»­å¼€å§‹ç¼–ç ã€‚<br>ã€€ã€€å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…å­—ç¬¦ä¸²ï¼Œåˆ™è¾“å‡º(0, 0, c)ï¼Œcä¸ºå¾…ç¼–ç åŒºä¸‹ä¸€ä¸ªç­‰å¾…ç¼–ç çš„å­—ç¬¦ï¼Œçª—å£æ»‘åŠ¨â€œ1â€ã€‚</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/junyuhuang/p/4138376.html">LZ77å‹ç¼©ç®—æ³•ç¼–ç åŸç†è¯¦è§£(ç»“åˆå›¾ç‰‡å’Œç®€å•ä»£ç )</a></p>
<p>ä¸‹é¢æˆ‘ä»¬ä»¥å­—ç¬¦ä¸²â€œ<code>abababc</code>â€ä¸ºä¾‹ï¼Œæ¥äº†è§£å…¶ç¼–ç è¿‡ç¨‹ï¼š</p>
<p>å‡è®¾æ»‘åŠ¨çª—å£çš„å¤§å°è¶³å¤Ÿå¤§(LZ777è®¾ç½®çš„æ»‘åŠ¨çª—å£æ˜¯32k)ï¼Œå¯ä»¥è¦†ç›–æ•´ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼š<br>	&emsp;å¾…ç¼–ç åŒºï¼šabababc<br>	&emsp;æœç´¢ç¼“å†²åŒºï¼šï¼ˆåˆå§‹ä¸ºç©ºï¼‰<br>	&emsp;æ“ä½œï¼šæœç´¢ç¼“å†²åŒºä¸ºç©ºï¼Œæ— æ³•æ‰¾åˆ°åŒ¹é…å­—ç¬¦ä¸²ã€‚<br>	&emsp;è¾“å‡ºï¼š(0, 0, a)ï¼ˆè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°åŒ¹é…ï¼Œè¾“å‡ºå­—ç¬¦aï¼‰<br>	&emsp;çª—å£æ»‘åŠ¨ï¼šçª—å£å‘å³æ»‘åŠ¨1ä¸ªå­—ç¬¦ã€‚<br>	&emsp;ç»“æœï¼šaå·²ç»è¢«ç¼–ç ï¼Œå‰©ä¸‹bababcã€‚<br><strong>ç¬¬äºŒæ­¥</strong>ï¼š<br>	&emsp;å¾…ç¼–ç åŒºï¼šbababc<br>	&emsp;æœç´¢ç¼“å†²åŒºï¼šaï¼ˆå·²ç»ç¼–ç çš„éƒ¨åˆ†ï¼‰<br>	&emsp;æ“ä½œï¼šåœ¨æœç´¢ç¼“å†²åŒºä¸­æŸ¥æ‰¾bçš„åŒ¹é…ã€‚æœç´¢ç¼“å†²åŒºä¸­æ²¡æœ‰bã€‚<br>	&emsp;è¾“å‡ºï¼š(0, 0, b)ï¼ˆè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°åŒ¹é…ï¼Œè¾“å‡ºå­—ç¬¦bï¼‰<br>	&emsp;çª—å£æ»‘åŠ¨ï¼šçª—å£å‘å³æ»‘åŠ¨1ä¸ªå­—ç¬¦ã€‚<br>	&emsp;ç»“æœï¼šabå·²ç»è¢«ç¼–ç ï¼Œå‰©ä¸‹ababcã€‚<br><strong>ç¬¬ä¸‰æ­¥</strong>ï¼š<br>	&emsp;å¾…ç¼–ç åŒºï¼šababc<br>	&emsp;æœç´¢ç¼“å†²åŒºï¼šabï¼ˆå·²ç»ç¼–ç çš„éƒ¨åˆ†ï¼‰<br>	&emsp;æ“ä½œï¼šåœ¨æœç´¢ç¼“å†²åŒºä¸­æŸ¥æ‰¾abçš„åŒ¹é…ã€‚æœç´¢ç¼“å†²åŒºä¸­å­˜åœ¨abï¼ŒåŒ¹é…é•¿åº¦ä¸º2ã€‚<br>	&emsp;è¾“å‡ºï¼š(2, 2)ï¼ˆè¡¨ç¤ºåŒ¹é…é•¿åº¦ä¸º2ï¼Œåç§»å€¼ä¸º2ï¼‰<br>	&emsp;çª—å£æ»‘åŠ¨ï¼šçª—å£å‘å³æ»‘åŠ¨2ä¸ªå­—ç¬¦ã€‚<br>	&emsp;ç»“æœï¼šababå·²ç»è¢«ç¼–ç ï¼Œå‰©ä¸‹abcã€‚<br><strong>ç¬¬å››æ­¥</strong>ï¼š<br>	&emsp;å¾…ç¼–ç åŒºï¼šabc<br>	&emsp;æœç´¢ç¼“å†²åŒºï¼šababï¼ˆå·²ç»ç¼–ç çš„éƒ¨åˆ†ï¼‰<br>	&emsp;æ“ä½œï¼šåœ¨æœç´¢ç¼“å†²åŒºä¸­æŸ¥æ‰¾abçš„åŒ¹é…ã€‚æœç´¢ç¼“å†²åŒºä¸­å­˜åœ¨abï¼ŒåŒ¹é…é•¿åº¦ä¸º2ã€‚<br>	&emsp;è¾“å‡ºï¼š(4, 2)ï¼ˆè¡¨ç¤ºåŒ¹é…é•¿åº¦ä¸º2ï¼Œåç§»å€¼ä¸º4ï¼‰<br>	&emsp;çª—å£æ»‘åŠ¨ï¼šçª—å£å‘å³æ»‘åŠ¨2ä¸ªå­—ç¬¦ã€‚<br>	&emsp;ç»“æœï¼šabababå·²ç»è¢«ç¼–ç ï¼Œå‰©ä¸‹cã€‚<br><strong>ç¬¬äº”æ­¥</strong>ï¼š<br>	&emsp;å¾…ç¼–ç åŒºï¼šc<br>	&emsp;æœç´¢ç¼“å†²åŒºï¼šabababï¼ˆå·²ç»ç¼–ç çš„éƒ¨åˆ†ï¼‰<br>	&emsp;æ“ä½œï¼šåœ¨æœç´¢ç¼“å†²åŒºä¸­æŸ¥æ‰¾cçš„åŒ¹é…ã€‚æœç´¢ç¼“å†²åŒºä¸­æ²¡æœ‰cã€‚<br>	&emsp;è¾“å‡ºï¼š(0, 0, c)ï¼ˆè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°åŒ¹é…ï¼Œè¾“å‡ºå­—ç¬¦cï¼‰<br>	&emsp;çª—å£æ»‘åŠ¨ï¼šçª—å£å‘å³æ»‘åŠ¨1ä¸ªå­—ç¬¦ã€‚<br>	&emsp;ç»“æœï¼šæ•´ä¸ªå­—ç¬¦ä¸²å·²ç»ç¼–ç å®Œæˆã€‚</p>
<p><strong>æœ€ç»ˆç¼–ç ç»“æœ</strong><br>&emsp;ç»è¿‡ä¸Šè¿°æ­¥éª¤ï¼Œå­—ç¬¦ä¸²abababcçš„LZ77ç¼–ç ç»“æœä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">0</span>, <span class="number">0</span>, a) (<span class="number">0</span>, <span class="number">0</span>, b) (<span class="number">2</span>, <span class="number">2</span>) (<span class="number">4</span>,<span class="number">2</span>) (<span class="number">0</span>, <span class="number">0</span>, c)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨<a target="_blank" rel="noopener" href="https://www.cnblogs.com/junyuhuang/p/4138376.html">LZ77å‹ç¼©ç®—æ³•ç¼–ç åŸç†è¯¦è§£(ç»“åˆå›¾ç‰‡å’Œç®€å•ä»£ç )</a>ç»™å®šçš„ä»£ç çš„ç¼–ç ç»“æœæ˜¯<br><img src="https://i-blog.csdnimg.cn/direct/fec766beb7344418952a7b715d53c1ea.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¯´æ˜ä¸Šè¿°ç¼–ç è¿‡ç¨‹åˆ†ææ­£ç¡®ï¼ï¼ï¼</p>
<p>ä¸Šé¢çš„å¦‚(0, 0, a)è¿™ä¸ªå…¶å®æ ¹æœ¬ä¸ç”¨å†™åç§»å’ŒåŒ¹é…é•¿åº¦ï¼Œä¿ç•™ä¸ºåŸå­—ç¬¦â€˜aâ€™ï¼Œå çš„ç¼–ç é•¿åº¦è¿˜æ›´çŸ­ä¸€äº›ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">0</span>, <span class="number">0</span>, a) (<span class="number">0</span>, <span class="number">0</span>, b) (<span class="number">2</span>, <span class="number">2</span>) (<span class="number">4</span>,<span class="number">2</span>) (<span class="number">0</span>, <span class="number">0</span>, c)</span><br></pre></td></tr></table></figure>
<p>å˜ä¸º</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ab</span>(<span class="number">2</span>, <span class="number">2</span>) (<span class="number">4</span>,<span class="number">2</span>)c</span><br></pre></td></tr></table></figure>
<h3 id="éœå¤«æ›¼ç¼–ç ç®—æ³•"><a href="#éœå¤«æ›¼ç¼–ç ç®—æ³•" class="headerlink" title="éœå¤«æ›¼ç¼–ç ç®—æ³•"></a>éœå¤«æ›¼ç¼–ç ç®—æ³•</h3><p>éœå¤«æ›¼ç¼–ç æ˜¯ä¸€ç§åŸºäºå­—ç¬¦é¢‘ç‡çš„å˜é•¿ç¼–ç æ–¹æ³•ï¼Œé€šè¿‡æ„å»ºéœå¤«æ›¼æ ‘æ¥ä¸ºæ¯ä¸ªå­—ç¬¦åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„äºŒè¿›åˆ¶ç¼–ç ã€‚éœå¤«æ›¼æ ‘çš„æ„å»ºè¿‡ç¨‹ä¾èµ–äºå­—ç¬¦çš„é¢‘ç‡ï¼Œé¢‘ç‡è¶Šé«˜çš„å­—ç¬¦é€šå¸¸ä¼šè¢«åˆ†é…è¾ƒçŸ­çš„ç¼–ç ã€‚<br>é¦–å…ˆæˆ‘ä»¬ç»Ÿè®¡â€<code>abababc</code>â€œä¸­æ¯ä¸€ä¸ªå­—ç¬¦å‡ºç°çš„é¢‘ç‡ï¼Œå¦‚ä¸‹æ‰€ç¤º</p>
<table>
<thead>
<tr>
<th align="center">a</th>
<th align="center">b</th>
<th align="center">c</th>
</tr>
</thead>
<tbody><tr>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
</tbody></table>
<p>æ ¹æ®éœå¤«æ›¼ç¼–ç çš„è§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§å­—ç¬¦é¢‘ç‡ä»ä½åˆ°é«˜æ„å»ºéœå¤«æ›¼æ ‘ã€‚ä»¥ä¸‹æ˜¯æ„å»ºè¿‡ç¨‹ï¼š</p>
<ol>
<li>å°†å­—ç¬¦ä¸²å‡ºç°çš„é¢‘ç‡è§†ä¸ºä¼˜å…ˆçº§ï¼Œæ”¾å…¥ä¸€ä¸ªæœ€å°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼š</li>
</ol>
<p><img src="https://i-blog.csdnimg.cn/direct/66beb0047e2b4dcc946eab5d59ab0559.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ol start="2">
<li>ç„¶åå¼¹å‡ºä¸¤ä¸ªä¼˜å…ˆçº§æœ€ä½çš„å­—ç¬¦ä½œä¸ºå­èŠ‚ç‚¹, æ„é€ å‡ºç¬¬ä¸€ä¸ªäºŒå‰æ ‘; çˆ¶èŠ‚ç‚¹çš„ä¼˜å…ˆçº§è§†ä¸ºä¸¤ä¸ªå­—èŠ‚ä¼˜å…ˆçº§ä¹‹å’Œ, ç„¶åæŠŠçˆ¶èŠ‚ç‚¹æ’å…¥é˜Ÿåˆ—ä¸­:<br><img src="https://i-blog.csdnimg.cn/direct/9488cb0dd1ed4da19e59aa5f48a6253d.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>é‡å¤è¿™ä¸ªæ“ä½œ, æœ€åæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€é¢—äºŒå‰æ ‘. è¿™ä¾¿æ˜¯ Huffmanç¼–ç  æ ‘.</li>
</ol>
<p><img src="https://i-blog.csdnimg.cn/direct/55978a3216824675b8365a88eade715c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4.  æˆ‘ä»¬æŠŠè¿™æ£µæ ‘çš„å·¦æ”¯ç¼–ç ä¸º 0, å³æ”¯ç¼–ç ä¸º 1, é‚£ä¹ˆä»æ ¹èŠ‚ç‚¹å‘ä¸‹éå†åˆ°å¶å­èŠ‚ç‚¹, å³å¯å¾—å‡ºç›¸åº”å­—ç¬¦çš„ Huffman ç¼–ç . å› æ­¤æˆ‘ä»¬å¾—åˆ°ä¸Šé¢ä¾‹å­çš„ Huffman ç¼–ç è¡¨ä¸º:<br><img src="https://i-blog.csdnimg.cn/direct/9b87beeda7f94b32b341d27d9c89286e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">1</span></span><br><span class="line">b:<span class="number">01</span></span><br><span class="line">c:<span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å¯¹å­—ç¬¦ä¸²ä¸­å‡ºç°çš„é¢‘ç‡éƒ½åšäº†ä¸€ä¸ªç»Ÿè®¡ï¼Œåªéœ€è¦è§£å†³åç§»é‡å’ŒåŒ¹é…é•¿åº¦çš„ç¼–ç å°±å¯ä»¥äº†ã€‚</p>
<p> DEFLATE ç®—æ³•å¯¹åç§»è·ç¦»å’ŒåŒ¹é…é•¿åº¦å·²ç»åšäº†ä¸€ä¸ªç»Ÿè®¡ï¼Œè§ä¸‹è¡¨ï¼š<br> <strong>åç§»è·ç¦»</strong>ï¼š<br> å®ƒæœ‰ 0 è‡³ 29 ä¸€å…± 30 ä¸ªç¼–ç . è·ç¦»ç¼–ç çš„å«ä¹‰å¦‚ä¸‹è¡¨æ‰€ç¤º:<br> <img src="https://i-blog.csdnimg.cn/direct/3b80d2f91e264311a064a808f2b952ae.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>codeè¡¨ç¤ºåŸºæœ¬çš„ç¼–ç è¡¨ç¤ºï¼Œæ¯”å¦‚ç¼–ç 9å¯¹åº”çš„åŸºå‡†è·ç¦»æ˜¯25</li>
<li>extraè¡¨ç¤ºè·ç¦»åŸºå‡†è·ç¦»åç§»äº†å¤šå°‘ï¼Œç¼–ç 9å¯¹åº”çš„extraä¸º3ä½ï¼Œæœ€å¤§ä¸º111ï¼ˆ7ï¼‰ï¼Œå³25+7ï¼Œæœ€å¤§å¯ä»¥è¡¨ç¤º32ã€‚</li>
<li>distanceï¼Œå¯ä»¥è¡¨ç¤ºçš„è·ç¦»èŒƒå›´<br><code>æ€»ç»“</code>ï¼šcode+extraå¯ä»¥çµæ´»è¡¨ç¤ºdistanceçš„ä»»ä½•æ•°å­—</li>
</ul>
<p> <strong>åŒ¹é…é•¿åº¦</strong>ï¼š<br>å¯¹äºé•¿åº¦, å®ƒä¸æ™®é€šå­—ç¬¦å…±ç”¨åŒä¸€ç¼–ç ç©ºé—´. è¿™ä¸ªç¼–ç ç©ºé—´ä¸€å…±æœ‰ 286 ä¸ªç¼–ç , èŒƒå›´æ˜¯ä» 0 è‡³ 285. å…¶ä¸­ 0 è‡³ 255 ä¸ºæ™®é€šå­—ç¬¦ç¼–ç , 256 è¡¨ç¤ºå‹ç¼©å—çš„ç»“æŸ; è€Œ 257 è‡³ 285 åˆ™è¡¨ç¤ºé•¿åº¦. é•¿åº¦ç¼–ç çš„å«ä¹‰å¦‚ä¸‹è¡¨æ‰€ç¤º:<br><img src="https://i-blog.csdnimg.cn/direct/cbc0b2d8ccf74078ac743dd0dfead6e0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ä¸è·ç¦»ç¼–ç ç±»ä¼¼, æ¯ä¸ªç¼–ç éƒ½è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªé•¿åº¦, è¡¨ç¤ºå¤šä¸ªé•¿åº¦æ—¶åé¢ä¼šæœ‰ extra ä½æŒ‡ç¤ºå…·ä½“çš„é•¿åº¦. é•¿åº¦ç¼–ç èƒ½è¡¨ç¤ºçš„é•¿åº¦èŒƒå›´ä¸º 3 è‡³ 258.<br>æ³¨æ„ï¼šæ‰€ä»¥åœ¨ DEFLATE ä¸­ï¼Œé•¿åº¦ 1<del>2 çš„é‡å¤<strong>ä¸ä¼šç”¨åŒ¹é…é¡¹è¡¨ç¤º</strong>ï¼ˆç›´æ¥æŠŠè¿™ 1</del>2 ä¸ªå­—èŠ‚åŸæ ·è¾“å‡ºï¼ˆå³ç”¨å­—é¢å€¼ç¼–ç ï¼‰é€šå¸¸æ¯”å¼•ç”¨åŒ¹é…ï¼ˆè¿˜è¦é¢å¤–ç¼–ç é•¿åº¦å’Œè·ç¦»ï¼‰æ›´çŸ­ï¼ï¼‰ï¼›åªæœ‰é•¿åº¦ â‰¥ 3 æ—¶æ‰ä¼šç”¨åŒ¹é…é¡¹ (length, distance) æ¥å¼•ç”¨é‡å¤å—ã€‚<br>è§£å‹æ—¶, å½“è¯»åˆ°ç¼–ç å°äºç­‰äº 255, åˆ™è®¤ä¸ºè¿™æ˜¯ä¸ªæ™®é€šå­—ç¬¦, åŸæ ·è¾“å‡ºå³å¯; è‹¥åœ¨ 257 è‡³ 285 ä¹‹é—´, åˆ™è¯´æ˜é‡åˆ°äº†ä¸€ä¸ªé‡å¤æ ‡è®°, è¿™æ„å‘³ç€å½“å‰ç¼–ç è¡¨ç¤ºçš„æ˜¯é•¿åº¦, ä¸”ä¸‹ä¸€ä¸ªç¼–ç è¡¨ç¤ºçš„æ˜¯è·ç¦». è§£ç å¾—åˆ°é•¿åº¦å’Œè·ç¦», å†åœ¨è§£å‹ç¼“å†²åŒºä¸­æ‰¾åˆ°ç›¸åº”çš„éƒ¨åˆ†è¾“å‡ºå³å¯; è‹¥ä¸º 256, åˆ™è¯´æ˜å‹ç¼©å—ç»“æŸäº†.</p>
<p>ä»LZ777ç¼–ç åˆ°éœå¤«æ›¼ç¼–ç <br>ä¸Šä¸€æ­¥çš„LZ777ç¼–ç ç»“æœä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ab</span>(<span class="number">2</span>, <span class="number">2</span>) (<span class="number">4</span>,<span class="number">2</span>)c</span><br></pre></td></tr></table></figure>
<p>å­—ç¬¦ä¸²ç»Ÿè®¡é¢‘ç‡ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">1</span></span><br><span class="line">b:<span class="number">01</span></span><br><span class="line">c:<span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>å­—ç¬¦ç¼–ç ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">101</span>(<span class="number">2</span>, <span class="number">2</span>) (<span class="number">4</span>,<span class="number">2</span>)<span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå¯¹åç§»è·ç¦»å’ŒåŒ¹é…é•¿åº¦è¿›è¡Œç¼–ç <br>ä½†æ˜¯è¿™é‡Œå‘ç°åŒ¹é…å­—ç¬¦é•¿åº¦æ˜¯ä»3å¼€å§‹çš„ï¼Œé‚£ä¹ˆè¿™ä¸ª2æ€ä¹ˆç¼–ç å‘¢ï¼ŸåŸæ¥è¿™é‡Œçš„deflateç®—æ³•æ˜¯ä½¿ç”¨äº†æ”¹è¿›å‹çš„LZ777ç®—æ³•<br>å‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://luyuhuang.tech/2020/04/28/gzip-and-deflate.html">Gzip æ ¼å¼å’Œ DEFLATE å‹ç¼©ç®—æ³•</a></p>
<h3 id="æ”¹è¿›å‹çš„LZ777ç®—æ³•"><a href="#æ”¹è¿›å‹çš„LZ777ç®—æ³•" class="headerlink" title="æ”¹è¿›å‹çš„LZ777ç®—æ³•"></a>æ”¹è¿›å‹çš„LZ777ç®—æ³•</h3><blockquote>
<p>LZ77å‹ç¼©ç®—æ³•å°†æ‰€æœ‰æ•°æ®éƒ½å¤„ç†æˆä¸ºä¸€ä¸ªä¸‰å…ƒç»„ä¸²ï¼Œæ¯ä¸ªä¸‰å…ƒç»„è‡³å°‘éœ€è¦3ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œå¦‚æœåœ¨åŠ¨æ€å­—å…¸ä¸­æœªæ‰¾åˆ°åŒ¹é…å­—ç¬¦ä¸²ï¼Œä¼šå°†1ä¸ªå­—èŠ‚è¾“å‡ºä¸º3ä¸ªå­—èŠ‚ï¼Œè¿™å°±å¯¼è‡´äº†å­—èŠ‚æµªè´¹ã€‚å› æ­¤åœ¨DEFLATEç®—æ³•ä¸­å¯¹å…¶ä½¿ç”¨çš„LZ77ç®—æ³•è¿›è¡Œäº†ä»¥ä¸‹æ”¹è¿›ï¼š</p>
<p>å¯¹åŒ¹é…å­—ç¬¦ä¸²é•¿åº¦å°äº3çš„å­—ç¬¦ä¸²ä¸å‹ç¼©ã€‚å› ä¸ºé•¿åº¦å°äº3çš„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ä¸‰å…ƒç»„è¡¨ç¤ºï¼Œå¯¹åŸå§‹æ•°æ®ä¸èƒ½èµ·åˆ°å‹ç¼©çš„ä½œç”¨ã€‚<br>å¯¹å­—ç¬¦ä¸²çš„åŒ¹é…é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼ŒèŒƒå›´ä¸ºï¼ˆ-128~127ï¼‰ï¼Œç”¨8bitè¡¨ç¤ºï¼Œæ»‘åŠ¨çª—å£å¤§å°ä¸º32KBï¼Œç”¨15bitè¡¨ç¤ºï¼Œå°†å‹ç¼©æ•°æ®æ„é€ ä¸ºæ ‡è¯†+æ•°æ®çš„å½¢å¼ï¼Œå…·ä½“å¦‚è¡¨3æ‰€ç¤ºã€‚è¯¥å­˜å‚¨æ–¹å¼ï¼Œé™ä½äº†å‹ç¼©æ•°æ®çš„å­˜å‚¨ç©ºé—´ã€‚<br>ç”±äºåªæŸ¥æ‰¾åŒ¹é…é•¿åº¦å¤§äº3çš„å­—ç¬¦ä¸²ï¼Œä¸ºæé«˜ç®—æ³•é€Ÿåº¦ï¼Œåœ¨æŸ¥æ‰¾åŒ¹é…å­—ç¬¦ä¸²æ—¶ï¼Œä½¿ç”¨äº†å“ˆå¸Œé“¾ç»“æ„æœç´¢ç®—æ³•ï¼Œå…¶ä¸­å“ˆå¸Œç®—æ³•å°†3å­—èŠ‚å‹ç¼©åˆ°2å­—èŠ‚ï¼Œè™½ç„¶å“ˆå¸Œé“¾ç»“æ„å­˜åœ¨æœç´¢åˆ°é”™è¯¯ç»“æœçš„å¯èƒ½ï¼Œä½†è¿˜æ˜¯å¤§å¹…æé«˜äº†æœç´¢é€Ÿåº¦ã€‚</p>
</blockquote>
<p>æ‰€ä»¥æœ€ç»ˆçš„ç¼–ç ç»“æœä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">1</span></span><br><span class="line">b:<span class="number">01</span></span><br><span class="line">c:<span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„å­—ç¬¦ä¸²â€œabababcâ€ï¼Œè¿ç»­åŒ¹é…éƒ½æ²¡æœ‰è¶…è¿‡ä¸‰ä¸ªå­—ç¬¦ï¼Œç›´æ¥æŒ‰ç…§è¿™ä¸ªå­—ç¬¦ä¸²å¸¸é‡è¿›è¡Œç¼–ç å³å¯</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10110110100</span></span><br></pre></td></tr></table></figure>

<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><h3 id="å‹ç¼©å¯¹è±¡"><a href="#å‹ç¼©å¯¹è±¡" class="headerlink" title="å‹ç¼©å¯¹è±¡"></a>å‹ç¼©å¯¹è±¡</h3><p>åœ¨å¼€å§‹ç¼–å†™ä»£ç å‰ï¼Œæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šï¼Œéœ€è¦å‹ç¼©çš„å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ol>
<li>è§†é¢‘ã€éŸ³é¢‘ã€å›¾ç‰‡ç­‰æ–‡ä»¶æœ¬èº«å°±æ˜¯å‹ç¼©æ ¼å¼<br>mp4ã€jpgã€pngã€aviã€mp3 è¿™äº›æ ¼ å·²ç»è¿‡å¤æ‚å‹ç¼©ç®—æ³•å¤„ç†ï¼ˆå¦‚ H.264ã€H.265ã€JPEGã€LZ77 ç­‰ï¼‰ã€‚<br>ğŸ‘‰ æ‰€ä»¥å†æ¬¡ä½¿ç”¨ GZIP å‹ç¼©ä¸ä¼šæœ‰å¤ªå¤§æ•ˆæœï¼Œåè€Œå¯èƒ½ç•¥å¾®å¢åŠ ä½“ç§¯ã€‚</li>
<li>GZIP å¯¹äºŒè¿›åˆ¶å†…å®¹çš„å‹ç¼©æ•ˆç‡å¾ˆä½<br>GZIP æ˜¯ä¸ºæ–‡æœ¬å†…å®¹è®¾è®¡çš„å‹ç¼©ç®—æ³•ï¼ˆå¦‚ HTMLã€JSONã€JavaScript ç­‰ï¼‰ã€‚<br>å®ƒä¾èµ–æ•°æ®çš„å¯é¢„æµ‹æ€§å’Œé‡å¤æ€§ï¼ˆå¦‚æ–‡æœ¬ä¸­çš„é‡å¤è¯ã€ç©ºæ ¼ç­‰ï¼‰æ¥å‹ç¼©ã€‚<br>è§†é¢‘æ–‡ä»¶çš„æ•°æ®æ¨¡å¼çœ‹èµ·æ¥æ˜¯â€œéšæœºçš„â€ï¼Œå‹ç¼©å™¨æ— æ³•ä»ä¸­æ‰¾åˆ°æœ‰æ•ˆçš„æ¨¡å¼ã€‚</li>
</ol>
<h3 id="gzipå®ç°"><a href="#gzipå®ç°" class="headerlink" title="gzipå®ç°"></a>gzipå®ç°</h3><p><code>GzipMiddleware.h</code>ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">    <span class="built_in">GzipMiddleware</span>():<span class="built_in">clientSupportGzip_</span>(<span class="literal">true</span>)&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">before</span><span class="params">(HttpRequest&amp; request)</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">after</span><span class="params">(HttpResponse&amp; response)</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setClientSupportGzip</span><span class="params">(<span class="type">bool</span> flag)</span></span>&#123;clientSupportGzip_=flag;&#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isClinetSupportGzip</span><span class="params">()</span> <span class="type">const</span> </span>&#123;<span class="keyword">return</span> clientSupportGzip_;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">double</span> <span class="title">getGzipEnableRate</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="type">uint64_t</span> total = totalRequests_.<span class="built_in">load</span>();</span><br><span class="line">        <span class="keyword">return</span> total == <span class="number">0</span> ? <span class="number">0.0</span> : (<span class="type">double</span>)gzipAppliedCount_.<span class="built_in">load</span>() / total;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">double</span> <span class="title">getAverageCompressionRatio</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="type">uint64_t</span> original = originalSizeSum_.<span class="built_in">load</span>();</span><br><span class="line">        <span class="keyword">return</span> original == <span class="number">0</span> ? <span class="number">0.0</span> : (<span class="type">double</span>)compressedSizeSum_.<span class="built_in">load</span>() / original;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">compressGzip</span><span class="params">(<span class="type">const</span> std::string&amp; input, std::string&amp; output)</span></span>;</span><br><span class="line">    <span class="type">bool</span> clientSupportGzip_;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// gzipç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">checkArchive</span><span class="params">()</span></span>;  <span class="comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å½’æ¡£</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">resetStats</span><span class="params">()</span></span>;    <span class="comment">// é‡ç½®ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">    std::atomic&lt;<span class="type">uint64_t</span>&gt; totalRequests_&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    std::atomic&lt;<span class="type">uint64_t</span>&gt; gzipAppliedCount_&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    std::atomic&lt;<span class="type">uint64_t</span>&gt; originalSizeSum_&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    std::atomic&lt;<span class="type">uint64_t</span>&gt; compressedSizeSum_&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// std::function&lt;void(uint64_t, uint64_t, uint64_t, uint64_t)&gt; archiveCallback_;</span></span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="keyword">constexpr</span> <span class="type">uint64_t</span> MAX_REQUESTS_BEFORE_ARCHIVE = <span class="number">1e9</span>;</span><br><span class="line">    <span class="type">static</span> <span class="keyword">constexpr</span> <span class="type">uint64_t</span> MAX_ORIGINAL_SIZE_BEFORE_ARCHIVE = <span class="number">1ULL</span> &lt;&lt; <span class="number">40</span>; <span class="comment">// 1 TB</span></span><br></pre></td></tr></table></figure>

<p><code>GzipMiddleware.cpp</code>ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">GzipMiddleware::before</span><span class="params">(HttpRequest&amp; request)</span></span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">    <span class="comment">// ä»å®¢æˆ·ç«¯è¯·æ±‚å¤´ä¸­è·å– Accept-Encoding å­—æ®µ</span></span><br><span class="line">    std::string acceptEncoding=request.<span class="built_in">getHeader</span>(<span class="string">&quot;Accept-Encoding&quot;</span>);</span><br><span class="line">     <span class="comment">// åˆ¤æ–­æ˜¯å¦åŒ…å« &quot;gzip&quot; å…³é”®å­—</span></span><br><span class="line">    <span class="comment">// å¦‚æœåŒ…å«ï¼Œè¯´æ˜å®¢æˆ·ç«¯æ”¯æŒ gzip å‹ç¼©</span></span><br><span class="line">    <span class="comment">// å¦åˆ™ï¼Œä¸æ”¯æŒ gzip å‹ç¼©ï¼Œå¦‚æœä¸æ”¯æŒï¼Œå°±ä¸è¿›è¡Œgzipå‹ç¼©</span></span><br><span class="line">    acceptEncoding.<span class="built_in">find</span>(<span class="string">&quot;gzip&quot;</span>) != std::string::npos?<span class="built_in">setClientSupportGzip</span>(<span class="literal">true</span>):<span class="built_in">setClientSupportGzip</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//--------------------------------------</span></span><br><span class="line"><span class="comment">// GzipMiddleware::after</span></span><br><span class="line"><span class="comment">//--------------------------------------</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GzipMiddleware::after</span><span class="params">(HttpResponse&amp; response)</span> </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">    <span class="comment">// ç»Ÿè®¡æ€»è¯·æ±‚æ•°ï¼ˆç”¨äºåç»­å‹ç¼©ç»Ÿè®¡å½’æ¡£ï¼‰</span></span><br><span class="line">    totalRequests_++;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">isClinetSupportGzip</span>())     <span class="comment">// å¦‚æœå®¢æˆ·ç«¯ä¸æ”¯æŒ gzipï¼Œåˆ™ç›´æ¥è·³è¿‡å‹ç¼©</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ˜¯å¦åº”è¯¥å‹ç¼©ï¼Œæ¶ˆæ¯ä½“å¤§äº256å­—èŠ‚å¹¶ä¸”æ¶ˆæ¯ç±»å‹æ˜¯æ–‡æœ¬ã€htmlç­‰ç±»å‹æ‰å¯ä»¥</span></span><br><span class="line">    <span class="comment">//å¯¹äºè§†é¢‘ã€å›¾ç‰‡ç­‰å·²ç»ä½¿ç”¨äº†å…¶ä»–å‹ç¼©ç®—æ³•è¿›è¡Œå‹ç¼©äº†çš„ï¼Œå°±ä¸å†ä½¿ç”¨gzipè¿›è¡Œå‹ç¼©äº†</span></span><br><span class="line">    <span class="keyword">if</span> (!response.<span class="built_in">isShouldGzipCompress</span>()) </span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–åŸå§‹å“åº”ä½“å†…å®¹</span></span><br><span class="line">    <span class="type">const</span> std::string&amp; rawBody = response.<span class="built_in">getBody</span>();</span><br><span class="line">    std::string compressed;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å®é™…å‹ç¼©æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">compressGzip</span>(rawBody, compressed)) &#123;</span><br><span class="line">        <span class="comment">// LOG_INFO&lt;&lt;&quot;gzipAppliedCount_:&quot;&lt;&lt;gzipAppliedCount_.load()&lt;&lt;&quot;originalSizeSum_&quot;&lt;&lt;originalSizeSum_.load()&lt;&lt;&quot;compressedSizeSum_&quot;&lt;&lt;compressedSizeSum_.load();</span></span><br><span class="line">        gzipAppliedCount_++;</span><br><span class="line">        originalSizeSum_ += rawBody.<span class="built_in">size</span>();</span><br><span class="line">        compressedSizeSum_ +=compressed.<span class="built_in">size</span>();</span><br><span class="line">        response.<span class="built_in">addHeader</span>(<span class="string">&quot;Content-Encoding&quot;</span>, <span class="string">&quot;gzip&quot;</span>);  <span class="comment">// æ·»åŠ å“åº”å¤´æ ‡è¯†å‹ç¼©æ ¼å¼ä¸º gzip</span></span><br><span class="line">        response.<span class="built_in">setContentLength</span>(compressed.<span class="built_in">size</span>());    <span class="comment">// æ›´æ–° Content-Length ä¸ºå‹ç¼©åå¤§å°</span></span><br><span class="line">        response.<span class="built_in">setBody</span>(compressed);                    <span class="comment">// è®¾ç½®å‹ç¼©åçš„å“åº”ä½“</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å½’æ¡£ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">checkArchive</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//--------------------------------------</span></span><br><span class="line"><span class="comment">// GzipMiddleware::compressGzipå®é™…çš„å‹ç¼©å¤„ç†ç®—æ³•</span></span><br><span class="line"><span class="comment">//--------------------------------------</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">GzipMiddleware::compressGzip</span><span class="params">(<span class="type">const</span> std::string&amp; input, std::string&amp; output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> CHUNK = <span class="number">16384</span>; </span><br><span class="line">    z_stream strm&#123;&#125;;    <span class="comment">//zlib ç”¨äºå‹ç¼©çš„çŠ¶æ€ç»“æ„ä½“ï¼Œè®°å½•è¾“å…¥ã€è¾“å‡ºç¼“å†²åŒºçŠ¶æ€ç­‰</span></span><br><span class="line">    <span class="type">char</span> out[CHUNK];    <span class="comment">//è¾“å‡ºç¼“å†²åŒºï¼Œç”¨æ¥æš‚å­˜å‹ç¼©åçš„æ•°æ®å—</span></span><br><span class="line"></span><br><span class="line">    strm.zalloc = Z_NULL;</span><br><span class="line">    strm.zfree = Z_NULL;</span><br><span class="line">    strm.opaque = Z_NULL;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">deflateInit2</span>(&amp;strm,             <span class="comment">//å‹ç¼©çŠ¶æ€</span></span><br><span class="line">                     Z_BEST_COMPRESSION, <span class="comment">//å‹ç¼©ç­‰çº§ï¼ˆ0~9ï¼‰ï¼Œ9 è¡¨ç¤ºæœ€é«˜å‹ç¼©æ¯”ï¼Œç‰ºç‰²æ€§èƒ½</span></span><br><span class="line">                     Z_DEFLATED,         <span class="comment">//ä½¿ç”¨ DEFLATE ç®—æ³•</span></span><br><span class="line">                     <span class="number">15</span> + <span class="number">16</span>,           <span class="comment">//15ä½çª—å£å¤§å°(32KB), +16å¯ç”¨ GZIP æ ¼å¼è¾“å‡ºï¼ˆå¦åˆ™æ˜¯ zlibï¼‰</span></span><br><span class="line">                     <span class="number">8</span>,                 <span class="comment">//å†…éƒ¨å‹ç¼©ç¼“å†²åŒºå¤§å°å‚æ•°ï¼Œä¸€èˆ¬ä¸º 8</span></span><br><span class="line">                     Z_DEFAULT_STRATEGY) != Z_OK) <span class="comment">//é»˜è®¤å‹ç¼©ç­–ç•¥</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    strm.avail_in = input.<span class="built_in">size</span>();          <span class="comment">// å¾…å‹ç¼©æ•°æ®é•¿åº¦</span></span><br><span class="line">    strm.next_in = (Bytef*)input.<span class="built_in">data</span>();   <span class="comment">// å¾…å‹ç¼©æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        strm.avail_out = CHUNK;            <span class="comment">//å¾…å‹ç¼©æ•°æ®å­˜å‚¨buffer çš„é•¿åº¦ï¼Œå¦‚æœå¤šæ¬¡å†™ï¼Œä¼šè¦†ç›–ä¹‹å‰çš„å†™çš„æ•°æ®</span></span><br><span class="line">                                            <span class="comment">//å½“ç„¶ï¼Œä¹‹å‰çš„æ•°æ®å·²ç»è¢«è¯»èµ°äº†</span></span><br><span class="line">        strm.next_out = <span class="built_in">reinterpret_cast</span>&lt;Bytef*&gt;(out); <span class="comment">//å¾…å‹ç¼©æ•°æ®å­˜å‚¨çš„buffer</span></span><br><span class="line">        <span class="built_in">deflate</span>(&amp;strm, Z_FINISH);            <span class="comment">//å¦‚æœè¾“å…¥å’Œå¾…è¾“å‡ºçš„æ•°æ®éƒ½è¢«å¤„ç†å®Œï¼Œåˆ™è¿”å› Z_STREAM_END</span></span><br><span class="line">        <span class="type">size_t</span> have = CHUNK - strm.avail_out;<span class="comment">//æ€»é•¿åº¦-å½“å‰å¯å†™=å·²ç»å†™çš„æ•°æ®é•¿åº¦</span></span><br><span class="line">        output.<span class="built_in">append</span>(out, have);</span><br><span class="line">    &#125; <span class="keyword">while</span> (strm.avail_out == <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">deflateEnd</span>(&amp;strm);                       <span class="comment">//é‡Šæ”¾deflateInit2ç”³è¯·çš„ç©ºé—´</span></span><br><span class="line">    LOG_INFO&lt;&lt;<span class="string">&quot;åŸå§‹çš„æ•°æ®å¤§å°ä¸º:&quot;</span>&lt;&lt; input.<span class="built_in">size</span>();</span><br><span class="line">    LOG_INFO&lt;&lt;<span class="string">&quot;GZIPå‹ç¼©å®Œæˆ,å‹ç¼©æ¯”ä¾‹ä¸º:&quot;</span>&lt;&lt;(<span class="built_in">static_cast</span>&lt;<span class="type">double</span>&gt;(output.<span class="built_in">size</span>()) / input.<span class="built_in">size</span>());;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GzipMiddleware::checkArchive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå‹ç¼©çš„æ€»è¯·æ±‚æ•°æˆ–åŸå§‹æ•°æ®ç´¯è®¡å¤§å°è¶…è¿‡é˜ˆå€¼</span></span><br><span class="line">    <span class="comment">// å°±æ¸…ç†ç»Ÿè®¡æ•°æ®ï¼ˆå¯ç”¨äºåç»­ç›‘æ§ã€æ—¥å¿—ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (totalRequests_ &gt;= MAX_REQUESTS_BEFORE_ARCHIVE ||</span><br><span class="line">        originalSizeSum_ &gt;= MAX_ORIGINAL_SIZE_BEFORE_ARCHIVE) &#123;</span><br><span class="line"></span><br><span class="line">        totalRequests_ = <span class="number">0</span>;</span><br><span class="line">        gzipAppliedCount_ = <span class="number">0</span>;</span><br><span class="line">        originalSizeSum_ = <span class="number">0</span>;</span><br><span class="line">        compressedSizeSum_ = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ç°çš„å‡½æ•°æœ‰ï¼š</p>
<ul>
<li><code>before()</code>å‡½æ•°ï¼Œåˆ¤æ–­è¯·æ±‚æ˜¯å¦æ”¯æŒgzipå‹ç¼©</li>
<li><code>after()</code>å‡½æ•°ï¼Œç»Ÿè®¡è¯·æ±‚ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¸æ”¯æŒgzipå‹ç¼©å°±è¿”å›ï¼›å¦åˆ™å¯¹å…¶è¿›è¡Œgzipå‹ç¼©å¹¶å¡«å……å“åº”ä½“éƒ¨åˆ†</li>
<li><code>compressGzip()</code>å‡½æ•°ï¼Œå®é™…çš„å‹ç¼©å¤„ç†æ ¸å¿ƒéƒ¨åˆ†</li>
<li><code>checkArchive()</code>å‡½æ•°ï¼Œç”¨äºç»Ÿè®¡å‹ç¼©çš„æƒ…å†µï¼Œå¦‚å¹³å‡å‹ç¼©ç‡ç­‰</li>
</ul>
<p>æœ¬ä»£ç å®ç°<code>gzip</code>çš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯åœ¨<code>compressGzip</code>å‡½æ•°ä¸­è¿›è¡Œäº†å®é™…çš„å‹ç¼©ï¼Œ<code>compressGzip</code>è°ƒç”¨äº†<code>deflate</code>å‡½æ•°è¿›è¡Œå®é™…çš„å‹ç¼©ã€‚å…³äº<code>deflate</code>å‡½æ•°çš„ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_61476090/article/details/136592993">æ·±å…¥ç†è§£æ•°æ®å‹ç¼©æµç¨‹åŠ zlib åº“ä¸­ç›¸å…³å‡½æ•°</a></p>
<h2 id="è¿è¡Œåˆ†æ"><a href="#è¿è¡Œåˆ†æ" class="headerlink" title="è¿è¡Œåˆ†æ"></a>è¿è¡Œåˆ†æ</h2><p>è¿è¡ŒæœåŠ¡å™¨ï¼ŒæŸ¥çœ‹gzipå‹ç¼©æ˜¯å¦å¯ç”¨æˆåŠŸï¼Œæœ‰ä¸‰ä¸ªåœ°æ–¹å¯ä»¥æŸ¥çœ‹gzipçš„å‹ç¼©å¯ç”¨æ˜¯å¦æˆåŠŸã€‚åˆ†åˆ«æ˜¯æ—¥å¿—ç³»ç»Ÿã€wiresharkæŠ“åŒ…åˆ†æã€LiteHubå‰ç«¯å±•ç¤ºã€‚</p>
<h3 id="æ—¥å¿—æŸ¥çœ‹"><a href="#æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h3><p><img src="https://i-blog.csdnimg.cn/direct/53ab09d1730c4a34a4e47c85840f2ed9.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™ä¸ªå‹ç¼©æ¯”ä¾‹è®¡ç®—æ–¹å¼æ˜¯ï¼šå‹ç¼©åçš„æ•°æ®å¤§å°é™¤ä»¥å‹ç¼©å‰çš„æ•°æ®å¤§å°ã€‚å¯ä»¥çœ‹åˆ°gzipæ˜¯æœ‰æ•ˆå‹ç¼©æˆåŠŸäº†çš„ã€‚</p>
<h3 id="wiresharkæŠ“åŒ…æŸ¥çœ‹"><a href="#wiresharkæŠ“åŒ…æŸ¥çœ‹" class="headerlink" title="wiresharkæŠ“åŒ…æŸ¥çœ‹"></a>wiresharkæŠ“åŒ…æŸ¥çœ‹</h3><p><img src="https://i-blog.csdnimg.cn/direct/01844c8007ad426badcf683ae73e916f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é¦–å…ˆçœ‹å®¢æˆ·ç«¯å‘èµ·çš„æ¯ä¸€æ¬¡è¯·æ±‚éƒ½ä¼šæºå¸¦<code>Accept-Encoding:</code>å­—æ®µï¼Œè¯¥å­—æ®µä¸­æºå¸¦äº† <code>gzip, deflate</code>è¡¨ç¤ºæ”¯æŒ<code>gzip</code>å‹ç¼©æ–¹å¼ã€‚</p>
<p><img src="https://i-blog.csdnimg.cn/direct/dede28be630f4f83839cfd4b59dc07a8.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™ä¸ªæŠ¥æ–‡æ˜¯ä»æœåŠ¡å™¨å‘å›çš„å“åº”æŠ¥æ–‡ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°å‹ç¼©åçš„ä¿¡æ¯åŒ…åè‡ªåŠ¨è§£å‹ï¼Œä»2380å­—èŠ‚è§£å‹åˆ°åŸæ¥çš„9182å­—èŠ‚ï¼Œè¿™ä¹Ÿè¿›ä¸€æ­¥è¯´æ˜äº†è®¾è®¡çš„gzipå‹ç¼©ç®—æ³•æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<h3 id="åå°ç®¡ç†ç•Œé¢æŸ¥çœ‹"><a href="#åå°ç®¡ç†ç•Œé¢æŸ¥çœ‹" class="headerlink" title="åå°ç®¡ç†ç•Œé¢æŸ¥çœ‹"></a>åå°ç®¡ç†ç•Œé¢æŸ¥çœ‹</h3><p>æ­¤å¤–ï¼Œåœ¨LiteHubå‰ç«¯ç•Œé¢ï¼Œä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ç®¡ç†å‘˜è´¦æˆ·æŸ¥çœ‹å…·ä½“çš„gzipçš„ä¸€ä¸ªå‹ç¼©ä¿¡æ¯çš„ã€‚<br><img src="https://i-blog.csdnimg.cn/direct/83851fc1911e4c46a9cd62699348187a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å…³äºgzipçš„ç†è§£å°±åˆ†æåˆ°è¿™äº†ï¼Œå¦‚æœæœ‰ä¸æ°å½“ä¹‹å‰ï¼Œè¯·æ‚¨æŒ‡å‡ºã€‚</p>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2025/07/09/LiteHub%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/"
                                   title="LiteHubä¹‹æ•°æ®åº“è¿æ¥æ± "
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">LiteHubä¹‹æ•°æ®åº“è¿æ¥æ± </span>
                                        <span class="post-nav-item">Prev posts</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2025/07/04/LiteHub%E4%B9%8B%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%99%90%E6%B5%81%E5%AE%9E%E7%8E%B0/"
                                   title="LiteHubä¹‹ä¸­é—´ä»¶é™æµå®ç°"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">LiteHubä¹‹ä¸­é—´ä»¶é™æµå®ç°</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    if (hexo-config('comment') && hexo-config('comment.enable') == true && hexo-config('comment.use')) {
  if (hexo-config('comment.use') == "valine") {
    @import "./valine.styl"
  }
  else if (hexo-config('comment.use') == "gitalk") {
    @import "./gitalk.styl"
  }
  else if (hexo-config('comment.use') == "twikoo") {
    @import "./twikoo.styl"
  }
  else if (hexo-config('comment.use') == "waline") {
    @import "./waline.styl"
  }
}

.comments-container {
  display inline-block
  width 100%
  margin-top var(--component-gap)

  .comment-area-title {
    width 100%
    color var(--text-color-3)
    font-size 1.38rem
    line-height 2

    i {
      color var(--text-color-3)
    }

    +keep-tablet() {
      font-size 1.2rem
    }
  }


  .configuration-items-error-tip {
    display flex
    align-items center
    margin-top 1rem
    color var(--text-color-3)
    font-size 1rem

    i {
      margin-right 0.3rem
      color var(--text-color-3)
      font-size 1.2rem
    }
  }

  .comment-plugin-fail {
    display none
    flex-direction column
    align-items center
    justify-content space-around
    width 100%
    padding 2rem

    .fail-tip {
      color var(--text-color-3)
      font-size 1.1rem
    }

    .reload {
      margin-top 1rem
    }
  }

  .comment-plugin-loading {
    flex-direction column
    padding 1rem
    color var(--text-color-3)

    .loading-icon {
      color var(--text-color-4)
      font-size 2rem
    }

    .load-tip {
      margin-top 1rem
      color var(--text-color-4)
      font-size 1.1rem
    }
  }
}

                
            </div>
        </div>

        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            .footer {
  display flex
  flex-direction column
  align-items center
  justify-content center
  padding 1rem 0
  color var(--text-color-4)
  font-size 1rem

  a {
    color var(--text-color-4)

    &:hover {
      color var(--primary-color)
    }

    &.no-pointer {
      pointer-events none
    }
  }


  .info-item {
    position relative
    display flex
    flex-wrap wrap
    align-items center
    justify-content center
    box-sizing border-box
    margin 0.2rem 0
    color var(--text-color-4)

    &.count-info {
      display flex

      .count-item {
        &.uv
        &.pv {
          display none
        }
      }
    }


    &.deploy-info {

      display flex

      a
      .tooltip {
        display flex
        align-items center
      }

      img {
        height 1.08rem
        margin 0 0.4rem
      }
    }


    &.count-info
    &.record-info {

      .count-item
      .record-item {
        margin-right 15px

        &::before {
          position absolute
          top 50%
          left -10px
          box-sizing border-box
          transform translateY(-56%)
          content '|'
        }


        &:first-child {
          &::before {
            display none
          }
        }


        &:last-child {
          margin-right 0
        }


        .item-type {
          margin-right 4px
        }
      }
    }
  }


  .icon-animate {
    animation heartbeat-animate 1.2s ease-in-out infinite
  }
}

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            $li-margin-bottom = 0.8rem
$post-tool-button-width = 2.5rem

.post-tools-container {
  padding-top var(--component-gap)

  .post-tools-list {
    li {
      margin-bottom $li-margin-bottom

      &:last-child {
        margin-bottom 0
      }
    }


    li.tools-item {
      position relative
      box-sizing border-box
      width $post-tool-button-width
      height $post-tool-button-width
      color var(--text-color-3)
      font-size 1.2rem
      background var(--background-color-1)
      border-radius 50%
      box-shadow 2px 2px 5px var(--shadow-color)
      cursor pointer

      &:hover {
        box-shadow 2px 2px 8px var(--shadow-hover-color)
      }

      i {
        color var(--text-color-3)
      }


      &:hover {
        color var(--background-color-1)
        background var(--primary-color)

        i {
          color var(--background-color-1) !important
        }
      }


      &.toggle-show-toc {
        display none
      }


      &.go-to-comments {
        .post-comments-count {
          position absolute
          top 0
          right -1rem
          display none
          align-items center
          justify-content center
          box-sizing border-box
          min-width 1.1rem
          height 1.1rem
          padding 0 0.2rem
          color var(--badge-color)
          font-size 12px
          background var(--badge-background-color)
          border-radius 0.4rem

          +keep-tablet() {
            display none !important
          }
        }
      }
    }


    li.status-item {
      width $post-tool-button-width
      height $post-tool-button-width
      color var(--text-color-3)
      font-size 1.6rem
      cursor pointer


      &.post-lock {
        cursor default

        .fa-lock-open {
          display none
          color var(--keep-success-color)
        }

        &.decrypt {
          cursor pointer

          .fa-lock-open {
            display block
          }

          .fa-lock {
            display none
          }
        }
      }
    }
  }
}

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        $tools-item-width = 2.2rem
$tools-item-font-size = 1.1rem
$tools-item-border-radius = 0.2rem

.side-tools-show-handle {
  transform translateX(100%)
  opacity 0
  transition-t("transform, opacity", "0, 0", "0.26, 0.26", "linear, linear")

  &.show {
    transform translateX(0)
    opacity 1
  }
}

.side-tools-container {
  .tools-item {
    width $tools-item-width
    height $tools-item-width
    margin-bottom 0.25rem
    color var(--text-color-3)
    font-size $tools-item-font-size
    background var(--background-color-1)
    border-right none
    border-radius $tools-item-border-radius
    box-shadow 0.1rem 0.1rem 0.2rem var(--shadow-color)
    cursor pointer

    i {
      color var(--text-color-3)
    }

    &:hover {
      color var(--background-color-1)
      background var(--primary-color)
      box-shadow 0.2rem 0.2rem 0.4rem var(--shadow-color)

      i {
        color var(--background-color-1)
      }
    }


    +keep-tablet() {
      width $tools-item-width * 0.9
      height $tools-item-width * 0.9
      font-size $tools-item-font-size * 0.9

      &.toggle-show-toc-tablet
      &.go-to-comments-tablet {
        display flex !important
      }
    }

    &.rss {

      a {
        width 100%
        height 100%
        border-radius $tools-item-border-radius

        &:hover {
          color var(--background-color-1)
          background var(--primary-color)
          box-shadow 0.2rem 0.2rem 0.4rem var(--shadow-color)
        }
      }
    }

    &.toggle-show-toc-tablet
    &.go-to-comments-tablet {
      display none
    }
  }


  .exposed-tools-list {

    .tool-scroll-to-top {
      display none

      &.show {
        display flex
      }


      &.show-arrow {
        .percent {
          display none
        }

        .arrow {
          display flex
        }
      }


      &.show-percent {
        .percent {
          display flex
        }

        .arrow {
          display none
        }
      }


      &:hover {
        .percent {
          display none
        }

        .arrow {
          display flex
        }
      }


      .percent {
        font-size 1rem
      }
    }
  }
}

    </div>

    <!-- image mask -->
    .zoom-in-image-mask {
  position fixed
  top 0
  right 0
  bottom 0
  left 0
  z-index $z-index-8
  display flex
  align-items center
  justify-content center
  box-sizing border-box
  background rgba(0, 0, 0, 0)
  visibility hidden
  transition-t("visibility, background", "0, 0", "0.3, 0.3", "linear, linear")

  &.show {
    background rgba(0, 0, 0, 0.5)
    visibility visible

    .zoom-in-image {
      cursor zoom-out
    }
  }

  .zoom-in-image {
    position absolute
    z-index $z-index-9
    transform-origin center center
    will-change transform
    transition-t("transform", "0", "0.3", "linear")
  }
}


    <!-- local search -->
    

    <!-- tablet toc -->
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->


<!-- lazyload -->


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
